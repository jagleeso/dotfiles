#!/usr/bin/env bash
# Copy AOSP to GIT, point to GIT
top=$(git rev-parse --show-toplevel)
cd $top
# set -x
set -e
# SKIP: dalvik/vm/mterp/out
git ls-files -m | grep -v '/out/' | while read f; do
    git_f=~/android/team/jiawen/aosp/$(basename $top)/$f
    aosp_f=$AOSP/$(basename $top)/$f
    if [ ! -f ~/android/team/jiawen/aosp/$(basename $top)/$f ]; then
        # ls -l ~/android/team/jiawen/aosp/$(basename $top)/$f

        mkdir -p $(dirname ~/android/team/jiawen/aosp/$(basename $top)/$f)
        echo mv $aosp_f $git_f
        mv $aosp_f $git_f
        echo ln -s -T $git_f $aosp_f 
        ln -s -T $git_f $aosp_f 

    fi
done
