#!/bin/bash
set -e
source $HOME/.dot_common.sh

kill_gdbserver() {
    killall gdbserver || true
    sleep 0.5
}
run_emacs() {
    kill_gdbserver
    (
    cd $CN
    CNTK_DEBUG=yes emacs -nw
    )
}
run_gdb() {
    kill_gdbserver
    (
    cd $CN
    gdb -x gdb.break
    )
}

main() {
    if [ "$GDB" = 'yes' ]; then
        run_gdb "$@"
    else
        run_emacs "$@"
    fi
}

main "$@"
